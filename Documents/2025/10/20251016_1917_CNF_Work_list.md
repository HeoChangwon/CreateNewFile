# CreateNewFile ì‘ì—… ë‚´ì—­
**ì‘ì—… ì¼ì‹œ**: 2025-10-16
**ë¬¸ì„œ ìƒì„±**: 2025-10-16 19:17

---

## ğŸ“‹ ì‘ì—… ê°œìš”

ì´ë²ˆ ì‘ì—…ì—ì„œëŠ” CreateNewFile í”„ë¡œê·¸ë¨ì˜ ì°½ ìœ„ì¹˜ ì €ì¥ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ , NSIS ì¸ìŠ¤í†¨ëŸ¬ ê´€ë ¨ ê°œì„  ì‘ì—…ì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤.

---

## ğŸ”§ ì£¼ìš” ì‘ì—… ë‚´ì—­

### 1. ì°½ ìœ„ì¹˜ ì €ì¥ ë¬¸ì œ í•´ê²° â­ (í•µì‹¬ ì‘ì—…)

**ë¬¸ì œ ìƒí™©:**
- í”„ë¡œê·¸ë¨ ì¢…ë£Œ ì‹œ ì°½ ìœ„ì¹˜ê°€ ì˜¬ë°”ë¥´ê²Œ ì €ì¥ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ ë°œìƒ
- ì‹¤ì œ ì°½ ìœ„ì¹˜(ì˜ˆ: 2896, 664)ê°€ ì•„ë‹Œ ì´ˆê¸°ê°’(100, 100)ì´ ì €ì¥ë¨
- ë‹¤ìŒ ì‹¤í–‰ ì‹œ í•­ìƒ ì´ˆê¸° ìœ„ì¹˜ì—ì„œ ì°½ì´ ì—´ë¦¼

**ì›ì¸ ë¶„ì„:**
- `MainWindow.xaml.cs`ì—ì„œ ë…ë¦½ì ì¸ `SettingsService` ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- `MainViewModel`ì€ DI ì»¨í…Œì´ë„ˆì—ì„œ ì£¼ì…ë°›ì€ ë‹¤ë¥¸ `SettingsService` ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš©
- ë‘ ì¸ìŠ¤í„´ìŠ¤ê°€ ì„œë¡œ ë‹¤ë¥¸ ìºì‹œë¥¼ ìœ ì§€í•˜ì—¬ ë°ì´í„° ë¶ˆì¼ì¹˜ ë°œìƒ
- ì‹¤í–‰ íë¦„:
  1. `SaveWindowPositionSync()`: MainWindowì˜ SettingsServiceë¡œ ì‹¤ì œ ìœ„ì¹˜ ì €ì¥
  2. `SaveCurrentStateAsync()`: MainViewModelì˜ SettingsServiceê°€ ì˜¤ë˜ëœ ìºì‹œ(ì´ˆê¸°ê°’) ì‚¬ìš©
  3. ê²°ê³¼: ì´ˆê¸°ê°’ìœ¼ë¡œ ë‹¤ì‹œ ë®ì–´ì¨ì§

**í•´ê²° ë°©ë²•:**

**1) SettingsServiceì— ìºì‹œ ë¬´íš¨í™” ê¸°ëŠ¥ ì¶”ê°€**
- íŒŒì¼: `src/CreateNewFile/Services/SettingsService.cs`
- ìœ„ì¹˜: Line 609-616
- ë‚´ìš©: `ClearCache()` ë©”ì„œë“œ ì¶”ê°€
```csharp
public void ClearCache()
{
    lock (_lockObject)
    {
        _cachedSettings = null;
    }
}
```

**2) ISettingsService ì¸í„°í˜ì´ìŠ¤ í™•ì¥**
- íŒŒì¼: `src/CreateNewFile/Services/ISettingsService.cs`
- ìœ„ì¹˜: Line 120-124
- ë‚´ìš©: `ClearCache()` ë©”ì„œë“œ ì„ ì–¸ ì¶”ê°€

**3) MainViewModelì— ë˜í¼ ë©”ì„œë“œ ì¶”ê°€**
- íŒŒì¼: `src/CreateNewFile/ViewModels/MainViewModel.cs`
- ìœ„ì¹˜: Line 1441-1444
- ë‚´ìš©: `ClearSettingsCache()` ë©”ì„œë“œ ì¶”ê°€
```csharp
public void ClearSettingsCache()
{
    _settingsService.ClearCache();
}
```

**4) MainWindow_Closing ì´ë²¤íŠ¸ ìˆ˜ì •**
- íŒŒì¼: `src/CreateNewFile/Views/MainWindow.xaml.cs`
- ìœ„ì¹˜: Line 92-114
- ë‚´ìš©: ì°½ ìœ„ì¹˜ ì €ì¥ í›„ ìºì‹œ ë¬´íš¨í™” í˜¸ì¶œ
```csharp
// ìœˆë„ìš° ìœ„ì¹˜ë¥¼ ë¨¼ì € ì €ì¥
SaveWindowPositionSync();

// SettingsService ìºì‹œ ë¬´íš¨í™”
viewModel.ClearSettingsCache();

// MainViewModelì˜ í˜„ì¬ ìƒíƒœ ì €ì¥
Task.Run(async () => await viewModel.SaveCurrentStateAsync()).Wait(TimeSpan.FromSeconds(5));
```

**ê²°ê³¼:**
- í”„ë¡œê·¸ë¨ ì¢…ë£Œ ì‹œ ì‹¤ì œ ì°½ ìœ„ì¹˜ê°€ ì •í™•í•˜ê²Œ ì €ì¥ë¨
- ë‹¤ìŒ ì‹¤í–‰ ì‹œ ë§ˆì§€ë§‰ ìœ„ì¹˜ì—ì„œ ì°½ì´ ì˜¬ë°”ë¥´ê²Œ ë³µì›ë¨
- ì‚¬ìš©ì í™•ì¸: "ì´ì œì•¼ ìœˆë„ ì°½ì˜ ìœ„ì¹˜ê°€ ë‹¤ìŒ ì‹¤í–‰ì‹œì— ì œëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤"

---

### 2. ë””ë²„ê·¸ ë¡œê·¸ ì½”ë“œ ì œê±°

**ì‘ì—… ë‚´ìš©:**
í”„ë¡œë•ì…˜ ì½”ë“œì— ë‚¨ì•„ìˆë˜ ëª¨ë“  ë””ë²„ê·¸ ë¡œê·¸ë¥¼ ì œê±°í•˜ì—¬ ì½”ë“œë¥¼ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.

**ìˆ˜ì •ëœ íŒŒì¼:**

**1) MainWindow.xaml.cs**
- `PrepareWindow()` ë©”ì„œë“œ ê°„ì†Œí™”
- `MainWindow_SourceInitialized()` ê°„ì†Œí™”
- `RestoreWindowPositionSync()`: Debug.WriteLine ì œê±°
- `SaveWindowPositionSync()`: Debug.WriteLine ì œê±°
- `RegisterDragDropForElement()`: Debug.WriteLine ì œê±°

**2) MainViewModel.cs**
- `SaveLastSelectedItemsAsync()` ë©”ì„œë“œì—ì„œ Debug.WriteLine ì œê±°
- ì˜ˆì™¸ ì²˜ë¦¬ ê°„ì†Œí™”

**3) SettingsService.cs**
- `ClearCache()` ë©”ì„œë“œì—ì„œ Debug.WriteLine ì œê±°

**ê²°ê³¼:**
- ê¹”ë”í•œ í”„ë¡œë•ì…˜ ì½”ë“œ ìœ ì§€
- ë¶ˆí•„ìš”í•œ ë¡œê·¸ ì¶œë ¥ ì œê±°

---

### 3. NSIS ì¸ìŠ¤í†¨ëŸ¬ BrandingText ì¶”ê°€

**ì‘ì—… ë‚´ìš©:**
NSIS ì„¤ì¹˜ í”„ë¡œê·¸ë¨ í•˜ë‹¨ì— ì œí’ˆ ì •ë³´ë¥¼ í‘œì‹œí•˜ëŠ” BrandingTextë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.

**ìˆ˜ì •ëœ íŒŒì¼:**
- íŒŒì¼: `NSIS_installer/CreateNewFile_Installer.nsi`
- ìœ„ì¹˜: Line 36
- ë‚´ìš©:
```nsis
; Branding text (bottom of installer window)
BrandingText "${PRODUCT_NAME} v${PRODUCT_VERSION} (Build: ${DISPLAY_BUILD_DATE})"
```

**ê²°ê³¼:**
- ì„¤ì¹˜ í”„ë¡œê·¸ë¨ í•˜ë‹¨ì— "CreateNewFile v1.0.3.0 (Build: 2025-10-16 17:50)" í˜•ì‹ìœ¼ë¡œ í‘œì‹œë¨

---

### 4. NSIS ë¹Œë“œ ì¸ì½”ë”© ì˜¤ë¥˜ í•´ê²° â­ (ì¤‘ìš”)

**ë¬¸ì œ ìƒí™©:**
```
ì˜¤ë¥˜: NSIS ë¹Œë“œ ì‹¤íŒ¨!
ì˜¤ë¥˜ ë©”ì‹œì§€: Bad text encoding: temp_installer.nsi:10
Error in script "temp_installer.nsi" on line 10 -- aborting creation process
```

**ì›ì¸ ë¶„ì„:**
- Python ìŠ¤í¬ë¦½íŠ¸ê°€ `encoding='utf-8'`ë¡œ ì„ì‹œ NSI íŒŒì¼ ì €ì¥
- UTF-8 without BOMì€ NSISê°€ ANSIë¡œ ì¸ì‹
- Line 10ì˜ í•œê¸€ ì£¼ì„ `; ë¹Œë“œ ë‚ ì§œ (í‘œì‹œìš©, YYYY-MM-DD HH:MM í˜•ì‹)`ì´ ANSIë¡œ í•´ì„ë˜ë©´ì„œ ì˜¤ë¥˜ ë°œìƒ
- NSISëŠ” UTF-8 íŒŒì¼ì„ ì¸ì‹í•˜ê¸° ìœ„í•´ BOM(Byte Order Mark)ì´ í•„ìš”

**í•´ê²° ë°©ë²•:**

**1) Python ìŠ¤í¬ë¦½íŠ¸ ì¸ì½”ë”© ë³€ê²½**

**íŒŒì¼ 1**: `NSIS_installer/12_BuildInstaller.py`
- ìœ„ì¹˜: Line 110-113
- ë³€ê²½ ì „: `encoding='utf-8'`
- ë³€ê²½ í›„: `encoding='utf-8-sig'`
```python
# ì„ì‹œ NSI íŒŒì¼ ìƒì„± (UTF-8 BOMìœ¼ë¡œ ì €ì¥í•˜ì—¬ NSISê°€ UTF-8ë¡œ ì¸ì‹í•˜ë„ë¡ í•¨)
temp_nsi = Path("temp_installer.nsi")
with open(temp_nsi, 'w', encoding='utf-8-sig') as f:
    f.write('\n'.join(lines))
```

**íŒŒì¼ 2**: `NSIS_installer/10_BuildAll.py`
- ìœ„ì¹˜: Line 203-206
- ë³€ê²½ ë‚´ìš©: ë™ì¼í•˜ê²Œ `encoding='utf-8-sig'`ë¡œ ë³€ê²½

**2) NSI ìŠ¤í¬ë¦½íŠ¸ ì£¼ì„ ì˜ë¬¸í™” (ì¶”ê°€ ì•ˆì „ì¥ì¹˜)**
- íŒŒì¼: `NSIS_installer/CreateNewFile_Installer.nsi`
- ìœ„ì¹˜: Line 10
- ë³€ê²½ ì „: `; ë¹Œë“œ ë‚ ì§œ (í‘œì‹œìš©, YYYY-MM-DD HH:MM í˜•ì‹)`
- ë³€ê²½ í›„: `; Build date (YYYY-MM-DD HH:MM format)`

**3) ê¸°ì¡´ ì„ì‹œ íŒŒì¼ ì‚­ì œ**
- `temp_installer.nsi` íŒŒì¼ ì‚­ì œí•˜ì—¬ ìƒˆë¡œ ìƒì„±ë˜ë„ë¡ í•¨

**ê¸°ìˆ  ì„¤ëª…:**
- `utf-8-sig`: UTF-8 ì¸ì½”ë”©ì— BOM(Byte Order Mark)ì„ ì¶”ê°€
- BOMì€ íŒŒì¼ ì‹œì‘ ë¶€ë¶„ì— `EF BB BF` ë°”ì´íŠ¸ë¥¼ ì¶”ê°€í•˜ì—¬ UTF-8 íŒŒì¼ì„ì„ ëª…ì‹œ
- NSIS ì»´íŒŒì¼ëŸ¬ê°€ BOMì„ ê°ì§€í•˜ì—¬ UTF-8ë¡œ ì˜¬ë°”ë¥´ê²Œ ì¸ì‹

**ê²°ê³¼:**
- NSIS ì¸ìŠ¤í†¨ëŸ¬ ì •ìƒ ë¹Œë“œ
- ì‚¬ìš©ì í™•ì¸: "ì˜ ë©ë‹ˆë‹¤"

---

## ğŸ“ ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

### C# ì†ŒìŠ¤ íŒŒì¼
1. `src/CreateNewFile/Services/SettingsService.cs`
   - ClearCache() ë©”ì„œë“œ ì¶”ê°€
   - Debug.WriteLine ì œê±°

2. `src/CreateNewFile/Services/ISettingsService.cs`
   - ClearCache() ë©”ì„œë“œ ì„ ì–¸ ì¶”ê°€

3. `src/CreateNewFile/ViewModels/MainViewModel.cs`
   - ClearSettingsCache() ë˜í¼ ë©”ì„œë“œ ì¶”ê°€
   - SaveLastSelectedItemsAsync() ë””ë²„ê·¸ ë¡œê·¸ ì œê±°

4. `src/CreateNewFile/Views/MainWindow.xaml.cs`
   - MainWindow_Closingì—ì„œ ìºì‹œ ë¬´íš¨í™” í˜¸ì¶œ
   - ëª¨ë“  ë©”ì„œë“œì—ì„œ Debug.WriteLine ì œê±°

### NSIS ê´€ë ¨ íŒŒì¼
5. `NSIS_installer/CreateNewFile_Installer.nsi`
   - BrandingText ì¶”ê°€ (Line 36)
   - í•œê¸€ ì£¼ì„ì„ ì˜ë¬¸ìœ¼ë¡œ ë³€ê²½ (Line 10)

6. `NSIS_installer/12_BuildInstaller.py`
   - UTF-8-sig ì¸ì½”ë”©ìœ¼ë¡œ ë³€ê²½ (Line 112)

7. `NSIS_installer/10_BuildAll.py`
   - UTF-8-sig ì¸ì½”ë”©ìœ¼ë¡œ ë³€ê²½ (Line 205)

---

## ğŸ”‘ í•µì‹¬ ê¸°ìˆ  ê°œë…

### 1. Cache Invalidation Pattern (ìºì‹œ ë¬´íš¨í™” íŒ¨í„´)
- **ë¬¸ì œ**: ì™¸ë¶€ì—ì„œ íŒŒì¼ì„ ì§ì ‘ ìˆ˜ì •í•  ë•Œ ìºì‹œëœ ë°ì´í„°ê°€ ìµœì‹  ìƒíƒœë¥¼ ë°˜ì˜í•˜ì§€ ëª»í•¨
- **í•´ê²°**: íŒŒì¼ ìˆ˜ì • í›„ ëª…ì‹œì ìœ¼ë¡œ ìºì‹œë¥¼ ë¬´íš¨í™”í•˜ì—¬ ë‹¤ìŒ ì½ê¸° ì‹œ ìµœì‹  ë°ì´í„° ë¡œë“œ
- **êµ¬í˜„**: `ClearCache()` ë©”ì„œë“œë¥¼ í†µí•´ `_cachedSettings = null` ì„¤ì •

### 2. Dependency Injection (ì˜ì¡´ì„± ì£¼ì…)
- **ë¬¸ì œ**: ì„œë¡œ ë‹¤ë¥¸ ê°ì²´ê°€ ê°ìì˜ ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ìƒíƒœ ë¶ˆì¼ì¹˜ ë°œìƒ
- **í•´ê²°**: DI ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ ê³µìœ 
- **ì£¼ì˜ì **: ì¼ë¶€ ê°ì²´ê°€ DIë¥¼ ìš°íšŒí•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ê²½ìš° ì£¼ì˜ í•„ìš”

### 3. UTF-8 BOM (Byte Order Mark)
- **ê°œë…**: íŒŒì¼ì˜ ì¸ì½”ë”©ì„ ëª…ì‹œì ìœ¼ë¡œ í‘œì‹œí•˜ëŠ” ë§ˆì»¤
- **UTF-8 BOM**: `EF BB BF` 3ë°”ì´íŠ¸ë¡œ ì‹œì‘
- **Python**: `encoding='utf-8-sig'`ë¡œ BOM í¬í•¨ íŒŒì¼ ìƒì„±
- **NSIS**: BOMì´ ì—†ëŠ” UTF-8 íŒŒì¼ì„ ANSIë¡œ ì˜¤ì¸ì‹í•˜ì—¬ ì¸ì½”ë”© ì˜¤ë¥˜ ë°œìƒ

### 4. MVVM Architecture
- **Model**: ë°ì´í„° ë° ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (SettingsService)
- **View**: UI í‘œí˜„ (MainWindow.xaml)
- **ViewModel**: Viewì™€ Model ì¤‘ê°œ (MainViewModel)
- **ì£¼ì˜ì **: Viewì™€ ViewModelì´ ê°™ì€ ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•´ì•¼ ë°ì´í„° ì¼ê´€ì„± ìœ ì§€

---

## âœ… ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸

### ë¹Œë“œ ê²°ê³¼
- C# í”„ë¡œì íŠ¸ ë¹Œë“œ ì„±ê³µ
- NSIS ì¸ìŠ¤í†¨ëŸ¬ ë¹Œë“œ ì„±ê³µ
- ìƒì„±ëœ íŒŒì¼: `CreateNewFile_v1.0.003_Build_20251016_1750_Setup.exe`

### í…ŒìŠ¤íŠ¸ ê²°ê³¼
1. **ì°½ ìœ„ì¹˜ ì €ì¥/ë³µì›**: âœ… ì •ìƒ ë™ì‘ í™•ì¸
2. **NSIS ì¸ìŠ¤í†¨ëŸ¬ ë¹Œë“œ**: âœ… ì¸ì½”ë”© ì˜¤ë¥˜ í•´ê²°
3. **BrandingText í‘œì‹œ**: âœ… ì„¤ì¹˜ í”„ë¡œê·¸ë¨ í•˜ë‹¨ì— ì •ë³´ í‘œì‹œ

---

## ğŸ“ ì‚¬ìš©ì í”¼ë“œë°±

1. **ì°½ ìœ„ì¹˜ ë¬¸ì œ í•´ê²° í›„**:
   > "ì´ì œì•¼ ìœˆë„ ì°½ì˜ ìœ„ì¹˜ê°€ ë‹¤ìŒ ì‹¤í–‰ì‹œì— ì œëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤"

2. **NSIS ì¸ì½”ë”© ë¬¸ì œ í•´ê²° í›„**:
   > "ì˜ ë©ë‹ˆë‹¤"

---

## ğŸ¯ ì‘ì—… ì™„ë£Œ í•­ëª©

- [x] ì°½ ìœ„ì¹˜ ì €ì¥ ë¬¸ì œ ë¶„ì„ ë° í•´ê²°
- [x] Cache Invalidation íŒ¨í„´ êµ¬í˜„
- [x] ë””ë²„ê·¸ ë¡œê·¸ ì½”ë“œ ì œê±°
- [x] NSIS BrandingText ì¶”ê°€
- [x] NSIS UTF-8 ì¸ì½”ë”© ì˜¤ë¥˜ í•´ê²°
- [x] ì „ì²´ ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸ ì™„ë£Œ

---

## ğŸ“š ì°¸ê³  ì‚¬í•­

### ê°œë°œ í™˜ê²½
- IDE: Visual Studio
- .NET Version: 8.0
- UI Framework: WPF (Windows Presentation Foundation)
- NSIS Version: 3.x
- Python Version: 3.x

### ì£¼ìš” ë””ë ‰í† ë¦¬
- ì†ŒìŠ¤ ì½”ë“œ: `src/CreateNewFile/`
- NSIS ìŠ¤í¬ë¦½íŠ¸: `NSIS_installer/`
- ë¹Œë“œ ì¶œë ¥: `NSIS_installer/publish/framework-dependent/`

### ë°°í¬ ì •ë³´
- ì œí’ˆëª…: CreateNewFile
- ë²„ì „: 1.0.003
- ë¹Œë“œ ì¼ì‹œ: 2025-10-16 17:50
- ì„¤ì¹˜ ê²½ë¡œ: C:\Program Files\CreateNewFile
- ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­: Windows 10 ì´ìƒ, .NET 8.0 Runtime

---

**ë¬¸ì„œ ì‘ì„±ì**: Claude Code
**ìµœì¢… ìˆ˜ì •**: 2025-10-16 19:17
