# CreateNewFile Work List - 2025-08-26 14:55

## 작업 개요
**문서 작성자**: 허창원 with Claude Code Assistant  
**작업일시**: 2025-08-26 14:55  
**작업 목표**: NSIS 설치파일 생성 시스템 구축

## 주요 작업 내용

### 1. NSIS 설치파일 시스템 구축
#### 1.1 기본 구조 생성
- **위치**: `D:\Work_Claude\CreateNewFile\CreateNewFile\src\NSIS_installer\`
- **생성된 파일들**:
  - `CreateNewFile_Installer.nsi` - NSIS 설치 스크립트
  - `01_UpdateFromProject.bat` - 프로젝트 업데이트 배치파일
  - `02_BuildInstaller.bat` - 설치파일 빌드 배치파일
  - `LICENSE.txt` - MIT 라이센스 파일

#### 1.2 Python 스크립트 시스템 구축
- **10_BuildAll.py** - 전체 빌드 프로세스 자동화
- **11_UpdateFromProject.py** - 프로젝트 업데이트 및 퍼블리시
- **12_BuildInstaller.py** - NSIS 설치파일 빌드

### 2. 주요 기능 및 설정

#### 2.1 설치파일 특징
- **설치 형식**: Framework-dependent (.NET 8.0 Runtime 필요)
- **설치 경로**: `C:\Program Files\CreateNewFile`
- **파일명 형식**: `CreateNewFile_v1.0.001_Build_20250826_1549_Setup.exe`
- **아키텍처**: x64 최적화

#### 2.2 설치 기능
- 메인 프로그램 설치 (필수)
- 데스크톱 바로가기 생성 (옵션)
- 시작 메뉴 바로가기 생성
- 자동 시작 설정 (옵션, 기본 비활성화)
- 깨끗한 제거 기능

### 3. 해결한 주요 문제들

#### 3.1 한글 인코딩 문제
- **문제**: Python subprocess에서 UnicodeDecodeError 발생
- **해결**: 모든 `subprocess.run()` 호출에 `encoding='utf-8'` 추가

#### 3.2 아이콘 파일 복사 문제
- **문제**: publish 과정에서 Resources 폴더가 복사되지 않음
- **해결**: Python 스크립트에 아이콘 파일 수동 복사 로직 추가
- **경로**: `../CreateNewFile/Resources/CreateNewFile.ico` → `publish/framework-dependent/Resources/CreateNewFile.ico`

#### 3.3 NSIS VIProductVersion 형식 오류
- **문제**: "1.0.001" 형식이 NSIS X.X.X.X 형식과 맞지 않음
- **해결**: `convert_version_format()` 함수로 "1.0.001" → "1.0.1.0" 변환

#### 3.4 설치 경로 표준화
- **변경**: `C:\HeoChangwon\CreateNewFile` → `C:\Program Files\CreateNewFile`
- **이유**: x64 프로그램의 표준 설치 경로 준수
- **적용**: `$PROGRAMFILES64` 사용

### 4. 설정 관리 시스템

#### 4.1 버전 및 빌드 정보 수정 위치
**Python 스크립트 (권장)**:
```python
PRODUCT_NAME = "CreateNewFile"
PRODUCT_VERSION = "1.0.001"  
BUILD_DATE = "20250826_1549"
```

**파일 위치**:
- `10_BuildAll.py` 라인 17-19
- `11_UpdateFromProject.py` 라인 16-18  
- `12_BuildInstaller.py` 라인 17-19

#### 4.2 동적 설정 시스템
- Python 스크립트가 NSIS 스크립트의 버전 정보 자동 업데이트
- 임시 NSIS 파일 생성으로 원본 보존
- 설치파일명 자동 생성

### 5. 빌드 프로세스

#### 5.1 전체 빌드 프로세스 (10_BuildAll.py)
1. **단계 1**: 이전 빌드 정리
2. **단계 2**: 프로젝트 빌드 및 퍼블리시
3. **단계 3**: 아이콘 파일 복사
4. **단계 4**: 생성된 파일들 확인
5. **단계 5**: NSIS 설치 확인
6. **단계 6**: 동적 NSIS 스크립트 생성
7. **단계 7**: NSIS 설치파일 빌드

#### 5.2 개별 실행 옵션
- `11_UpdateFromProject.py`: 프로젝트 빌드만
- `12_BuildInstaller.py`: 설치파일 생성만

### 6. 시스템 요구사항
- **개발 환경**: Windows 10 이상
- **필수 도구**: 
  - .NET 8.0 SDK
  - NSIS (C:\Program Files (x86)\NSIS\makensis.exe)
  - Python 3.x
- **대상 시스템**: Windows 10 이상, .NET 8.0 Runtime

### 7. 파일 구조
```
NSIS_installer/
├── CreateNewFile_Installer.nsi     # NSIS 설치 스크립트
├── LICENSE.txt                     # MIT 라이센스
├── 01_UpdateFromProject.bat        # 배치파일 (기존)
├── 02_BuildInstaller.bat          # 배치파일 (기존)  
├── 10_BuildAll.py                 # Python 전체 빌드
├── 11_UpdateFromProject.py        # Python 프로젝트 업데이트
├── 12_BuildInstaller.py           # Python 설치파일 빌드
└── publish/                       # 빌드 결과물
    └── framework-dependent/
        ├── CreateNewFile.exe
        ├── Resources/
        │   └── CreateNewFile.ico
        └── config/
```

### 8. 사용법

#### 8.1 더블클릭 실행
- Python 스크립트들은 .py 연결프로그램으로 더블클릭 실행 가능
- 각 단계별 진행상황과 오류 메시지 표시

#### 8.2 명령행 실행
```cmd
cd D:\Work_Claude\CreateNewFile\CreateNewFile\src\NSIS_installer
python 10_BuildAll.py
```

### 9. 완료 상태
- ✅ NSIS 설치파일 시스템 완전 구축
- ✅ 한글 인코딩 문제 해결
- ✅ 아이콘 파일 복사 문제 해결
- ✅ 버전 형식 호환성 문제 해결
- ✅ x64 표준 설치 경로 적용
- ✅ 동적 설정 관리 시스템 구축

### 10. 향후 계획
- 설치파일 테스트 및 검증
- 디지털 서명 추가 검토
- 다국어 지원 검토 (필요시)

## 참고사항
- 모든 Python 스크립트는 UTF-8 인코딩 처리 완료
- NSIS 스크립트는 x64 아키텍처 최적화 완료  
- 설치파일명은 자동으로 빌드 정보 포함하여 생성
- 설정 변경은 Python 스크립트 상단 부분만 수정하면 됨